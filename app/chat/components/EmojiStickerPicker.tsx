'use client';

import { useState } from 'react';
import { Search, X } from 'lucide-react';
import { officialStickers } from '../lib/chatHelpers';

interface EmojiStickerPickerProps {
  platform: 'line' | 'facebook';
  onEmojiSelect: (emoji: string) => void;
  onStickerSelect: (packageId: string, stickerId: string) => void;
  onClose: () => void;
}

type EmojiItem = { e: string; k: string };

export default function EmojiStickerPicker({ platform, onEmojiSelect, onStickerSelect, onClose }: EmojiStickerPickerProps) {
  const [emojiTab, setEmojiTab] = useState<'emoji' | 'sticker'>('emoji');
  const [emojiSearch, setEmojiSearch] = useState('');

  const emojiGroups: { label: string; key: string; items: EmojiItem[] }[] = [
    { label: '\u0e22\u0e34\u0e49\u0e21 & \u0e04\u0e19', key: 'smile', items: [
      { e: '\u{1f600}', k: 'smile \u0e22\u0e34\u0e49\u0e21 grin' }, { e: '\u{1f603}', k: 'smile \u0e22\u0e34\u0e49\u0e21 happy \u0e2a\u0e38\u0e02' }, { e: '\u{1f604}', k: 'smile \u0e22\u0e34\u0e49\u0e21 happy \u0e2a\u0e38\u0e02' }, { e: '\u{1f601}', k: 'grin \u0e22\u0e34\u0e49\u0e21\u0e01\u0e27\u0e49\u0e32\u0e07' }, { e: '\u{1f606}', k: 'laugh \u0e2b\u0e31\u0e27\u0e40\u0e23\u0e32\u0e30' }, { e: '\u{1f605}', k: 'sweat \u0e40\u0e2b\u0e07\u0e37\u0e48\u0e2d \u0e2b\u0e31\u0e27\u0e40\u0e23\u0e32\u0e30' }, { e: '\u{1f923}', k: 'rofl \u0e2b\u0e31\u0e27\u0e40\u0e23\u0e32\u0e30 \u0e2e\u0e32' }, { e: '\u{1f602}', k: 'joy \u0e2b\u0e31\u0e27\u0e40\u0e23\u0e32\u0e30 \u0e23\u0e49\u0e2d\u0e07\u0e44\u0e2b\u0e49 \u0e14\u0e35\u0e43\u0e08' }, { e: '\u{1f642}', k: 'smile \u0e22\u0e34\u0e49\u0e21' }, { e: '\u{1f60a}', k: 'blush \u0e22\u0e34\u0e49\u0e21 \u0e2d\u0e32\u0e22 \u0e19\u0e48\u0e32\u0e23\u0e31\u0e01' }, { e: '\u{1f607}', k: 'angel \u0e40\u0e17\u0e27\u0e14\u0e32 \u0e14\u0e35' }, { e: '\u{1f609}', k: 'wink \u0e02\u0e22\u0e34\u0e1a\u0e15\u0e32' },
      { e: '\u{1f60d}', k: 'heart eyes love \u0e23\u0e31\u0e01 \u0e2b\u0e31\u0e27\u0e43\u0e08 \u0e15\u0e32\u0e2b\u0e31\u0e27\u0e43\u0e08' }, { e: '\u{1f970}', k: 'love \u0e23\u0e31\u0e01 \u0e2b\u0e31\u0e27\u0e43\u0e08 hearts' }, { e: '\u{1f618}', k: 'kiss \u0e08\u0e39\u0e1a \u0e23\u0e31\u0e01 love' }, { e: '\u{1f617}', k: 'kiss \u0e08\u0e39\u0e1a' }, { e: '\u{1f61a}', k: 'kiss \u0e08\u0e39\u0e1a \u0e2d\u0e32\u0e22' }, { e: '\u{1f60b}', k: 'yummy \u0e2d\u0e23\u0e48\u0e2d\u0e22 \u0e25\u0e34\u0e49\u0e19' }, { e: '\u{1f61b}', k: 'tongue \u0e25\u0e34\u0e49\u0e19' }, { e: '\u{1f61c}', k: 'wink tongue \u0e25\u0e34\u0e49\u0e19 \u0e02\u0e22\u0e34\u0e1a' }, { e: '\u{1f92a}', k: 'crazy \u0e1a\u0e49\u0e32 \u0e25\u0e34\u0e49\u0e19' }, { e: '\u{1f61d}', k: 'tongue \u0e25\u0e34\u0e49\u0e19' },
      { e: '\u{1f911}', k: 'money \u0e40\u0e07\u0e34\u0e19 \u0e23\u0e27\u0e22' }, { e: '\u{1f917}', k: 'hug \u0e01\u0e2d\u0e14' }, { e: '\u{1f92d}', k: 'oops \u0e2d\u0e38\u0e4a\u0e22 \u0e1b\u0e34\u0e14\u0e1b\u0e32\u0e01' }, { e: '\u{1fae2}', k: 'oops \u0e15\u0e01\u0e43\u0e08' }, { e: '\u{1f92b}', k: 'quiet \u0e40\u0e07\u0e35\u0e22\u0e1a \u0e0a\u0e39\u0e48' }, { e: '\u{1f914}', k: 'think \u0e04\u0e34\u0e14' }, { e: '\u{1f610}', k: 'neutral \u0e40\u0e09\u0e22' }, { e: '\u{1f611}', k: 'expressionless \u0e40\u0e09\u0e22' }, { e: '\u{1f636}', k: 'silent \u0e40\u0e07\u0e35\u0e22\u0e1a \u0e44\u0e21\u0e48\u0e1e\u0e39\u0e14' },
      { e: '\u{1f60f}', k: 'smirk \u0e22\u0e34\u0e49\u0e21\u0e41\u0e01\u0e21' }, { e: '\u{1f612}', k: 'unamused \u0e40\u0e1a\u0e37\u0e48\u0e2d' }, { e: '\u{1f644}', k: 'eye roll \u0e01\u0e25\u0e2d\u0e01\u0e15\u0e32' }, { e: '\u{1f62c}', k: 'grimace \u0e22\u0e34\u0e49\u0e21\u0e41\u0e2b\u0e22' }, { e: '\u{1f60c}', k: 'relieved \u0e42\u0e25\u0e48\u0e07\u0e43\u0e08' }, { e: '\u{1f614}', k: 'sad \u0e40\u0e28\u0e23\u0e49\u0e32 pensive' }, { e: '\u{1f62a}', k: 'sleepy \u0e07\u0e48\u0e27\u0e07' }, { e: '\u{1f924}', k: 'drool \u0e19\u0e49\u0e33\u0e25\u0e32\u0e22 \u0e2d\u0e22\u0e32\u0e01' }, { e: '\u{1f634}', k: 'sleep \u0e19\u0e2d\u0e19 \u0e2b\u0e25\u0e31\u0e1a zzz' },
      { e: '\u{1f637}', k: 'mask \u0e2b\u0e19\u0e49\u0e32\u0e01\u0e32\u0e01 \u0e1b\u0e48\u0e27\u0e22' }, { e: '\u{1f912}', k: 'sick \u0e1b\u0e48\u0e27\u0e22 \u0e44\u0e02\u0e49' }, { e: '\u{1f915}', k: 'hurt \u0e40\u0e08\u0e47\u0e1a \u0e1a\u0e32\u0e14\u0e40\u0e08\u0e47\u0e1a' }, { e: '\u{1f922}', k: 'nauseous \u0e04\u0e25\u0e37\u0e48\u0e19\u0e44\u0e2a\u0e49' }, { e: '\u{1f92e}', k: 'vomit \u0e2d\u0e49\u0e27\u0e01' }, { e: '\u{1f974}', k: 'woozy \u0e40\u0e21\u0e32' }, { e: '\u{1f635}', k: 'dizzy \u0e21\u0e36\u0e19 \u0e40\u0e27\u0e35\u0e22\u0e19' }, { e: '\u{1f92f}', k: 'explode \u0e23\u0e30\u0e40\u0e1a\u0e34\u0e14 \u0e15\u0e01\u0e43\u0e08 mind blown' },
      { e: '\u{1f973}', k: 'party \u0e1b\u0e32\u0e23\u0e4c\u0e15\u0e35\u0e49 \u0e09\u0e25\u0e2d\u0e07 celebrate' }, { e: '\u{1f978}', k: 'disguise \u0e1b\u0e25\u0e2d\u0e21\u0e15\u0e31\u0e27' }, { e: '\u{1f60e}', k: 'cool \u0e40\u0e17\u0e48 \u0e41\u0e27\u0e48\u0e19 sunglasses' }, { e: '\u{1f913}', k: 'nerd \u0e40\u0e19\u0e34\u0e23\u0e4c\u0e14 \u0e41\u0e27\u0e48\u0e19' }, { e: '\u{1f9d0}', k: 'monocle \u0e2a\u0e07\u0e2a\u0e31\u0e22' },
      { e: '\u{1f615}', k: 'confused \u0e2a\u0e31\u0e1a\u0e2a\u0e19 \u0e07\u0e07' }, { e: '\u{1f61f}', k: 'worried \u0e01\u0e31\u0e07\u0e27\u0e25' }, { e: '\u{1f641}', k: 'sad \u0e40\u0e28\u0e23\u0e49\u0e32' }, { e: '\u2639\ufe0f', k: 'sad \u0e40\u0e28\u0e23\u0e49\u0e32' }, { e: '\u{1f62e}', k: 'open mouth \u0e2d\u0e49\u0e32\u0e1b\u0e32\u0e01 \u0e15\u0e01\u0e43\u0e08' }, { e: '\u{1f62f}', k: 'hushed \u0e40\u0e07\u0e35\u0e22\u0e1a \u0e15\u0e01\u0e43\u0e08' }, { e: '\u{1f632}', k: 'astonished \u0e15\u0e01\u0e43\u0e08 wow' }, { e: '\u{1f633}', k: 'flushed \u0e2d\u0e32\u0e22 \u0e41\u0e14\u0e07' },
      { e: '\u{1f97a}', k: 'pleading \u0e02\u0e2d\u0e23\u0e49\u0e2d\u0e07 \u0e19\u0e48\u0e32\u0e2a\u0e07\u0e2a\u0e32\u0e23' }, { e: '\u{1f979}', k: 'holding tears \u0e19\u0e49\u0e33\u0e15\u0e32 \u0e0b\u0e36\u0e49\u0e07' }, { e: '\u{1f622}', k: 'cry \u0e23\u0e49\u0e2d\u0e07\u0e44\u0e2b\u0e49 \u0e40\u0e28\u0e23\u0e49\u0e32 sad' }, { e: '\u{1f62d}', k: 'sob \u0e23\u0e49\u0e2d\u0e07\u0e44\u0e2b\u0e49 \u0e40\u0e28\u0e23\u0e49\u0e32 cry loud' }, { e: '\u{1f631}', k: 'scream \u0e01\u0e23\u0e35\u0e4a\u0e14 \u0e15\u0e01\u0e43\u0e08' }, { e: '\u{1f624}', k: 'angry \u0e42\u0e01\u0e23\u0e18 \u0e1e\u0e48\u0e19\u0e44\u0e1f huff' }, { e: '\u{1f621}', k: 'angry \u0e42\u0e01\u0e23\u0e18 \u0e41\u0e14\u0e07 mad' }, { e: '\u{1f620}', k: 'angry \u0e42\u0e01\u0e23\u0e18' }, { e: '\u{1f92c}', k: 'curse \u0e14\u0e48\u0e32 \u0e42\u0e01\u0e23\u0e18 swear' },
      { e: '\u{1f480}', k: 'skull \u0e2b\u0e31\u0e27\u0e01\u0e30\u0e42\u0e2b\u0e25\u0e01 \u0e15\u0e32\u0e22 dead' }, { e: '\u{1f4a9}', k: 'poop \u0e2d\u0e36' }, { e: '\u{1f47b}', k: 'ghost \u0e1c\u0e35' }, { e: '\u{1f47d}', k: 'alien \u0e40\u0e2d\u0e40\u0e25\u0e35\u0e48\u0e22\u0e19' }, { e: '\u{1f916}', k: 'robot \u0e2b\u0e38\u0e48\u0e19\u0e22\u0e19\u0e15\u0e4c' },
    ]},
    { label: '\u0e21\u0e37\u0e2d & \u0e2b\u0e31\u0e27\u0e43\u0e08', key: 'hands', items: [
      { e: '\u{1f44d}', k: 'thumbs up like \u0e14\u0e35 \u0e44\u0e25\u0e04\u0e4c good' }, { e: '\u{1f44e}', k: 'thumbs down dislike \u0e44\u0e21\u0e48\u0e14\u0e35' }, { e: '\u{1f44f}', k: 'clap \u0e1b\u0e23\u0e1a\u0e21\u0e37\u0e2d bravo' }, { e: '\u{1f64c}', k: 'raise hands \u0e22\u0e01\u0e21\u0e37\u0e2d celebrate' }, { e: '\u{1f91d}', k: 'handshake \u0e08\u0e31\u0e1a\u0e21\u0e37\u0e2d deal' }, { e: '\u{1f64f}', k: 'pray \u0e44\u0e2b\u0e27\u0e49 \u0e02\u0e2d\u0e1a\u0e04\u0e38\u0e13 please thank' }, { e: '\u{1f4aa}', k: 'strong \u0e41\u0e02\u0e47\u0e07\u0e41\u0e23\u0e07 muscle' }, { e: '\u{1f44b}', k: 'wave \u0e42\u0e1a\u0e01\u0e21\u0e37\u0e2d hi bye \u0e2a\u0e27\u0e31\u0e2a\u0e14\u0e35' },
      { e: '\u270b', k: 'hand \u0e2b\u0e22\u0e38\u0e14 stop \u0e21\u0e37\u0e2d' }, { e: '\u{1f44c}', k: 'ok \u0e44\u0e14\u0e49 \u0e14\u0e35' }, { e: '\u270c\ufe0f', k: 'peace \u0e2a\u0e2d\u0e07 victory' }, { e: '\u{1f91e}', k: 'fingers crossed \u0e42\u0e0a\u0e04\u0e14\u0e35 luck' }, { e: '\u{1faf6}', k: 'heart hands \u0e2b\u0e31\u0e27\u0e43\u0e08 \u0e21\u0e37\u0e2d love \u0e23\u0e31\u0e01' }, { e: '\u{1f91f}', k: 'love you \u0e23\u0e31\u0e01\u0e19\u0e30' }, { e: '\u{1f918}', k: 'rock \u0e23\u0e47\u0e2d\u0e04' }, { e: '\u{1f919}', k: 'call \u0e42\u0e17\u0e23' },
      { e: '\u{1f448}', k: 'point left \u0e0a\u0e35\u0e49\u0e0b\u0e49\u0e32\u0e22' }, { e: '\u{1f449}', k: 'point right \u0e0a\u0e35\u0e49\u0e02\u0e27\u0e32' }, { e: '\u{1f446}', k: 'point up \u0e0a\u0e35\u0e49\u0e02\u0e36\u0e49\u0e19' }, { e: '\u{1f447}', k: 'point down \u0e0a\u0e35\u0e49\u0e25\u0e07' }, { e: '\u{1f44a}', k: 'fist \u0e0a\u0e01 \u0e15\u0e48\u0e2d\u0e22 punch' }, { e: '\u270a', k: 'fist \u0e01\u0e33\u0e1b\u0e31\u0e49\u0e19 \u0e2a\u0e39\u0e49 fight' },
      { e: '\u2764\ufe0f', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 \u0e23\u0e31\u0e01 love red \u0e41\u0e14\u0e07' }, { e: '\u{1f9e1}', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 orange \u0e2a\u0e49\u0e21' }, { e: '\u{1f49b}', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 yellow \u0e40\u0e2b\u0e25\u0e37\u0e2d\u0e07' }, { e: '\u{1f49a}', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 green \u0e40\u0e02\u0e35\u0e22\u0e27' }, { e: '\u{1f499}', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 blue \u0e19\u0e49\u0e33\u0e40\u0e07\u0e34\u0e19' }, { e: '\u{1f49c}', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 purple \u0e21\u0e48\u0e27\u0e07' }, { e: '\u{1f5a4}', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 black \u0e14\u0e33' }, { e: '\u{1f90d}', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 white \u0e02\u0e32\u0e27' }, { e: '\u{1f90e}', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 brown \u0e19\u0e49\u0e33\u0e15\u0e32\u0e25' },
      { e: '\u{1f494}', k: 'broken heart \u0e2b\u0e31\u0e27\u0e43\u0e08\u0e2a\u0e25\u0e32\u0e22 \u0e2d\u0e01\u0e2b\u0e31\u0e01' }, { e: '\u2764\ufe0f\u200d\u{1f525}', k: 'heart fire \u0e2b\u0e31\u0e27\u0e43\u0e08 \u0e44\u0e1f' }, { e: '\u{1f495}', k: 'hearts \u0e2b\u0e31\u0e27\u0e43\u0e08 \u0e04\u0e39\u0e48 love' }, { e: '\u{1f497}', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 growing \u0e42\u0e15' }, { e: '\u{1f496}', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 sparkle \u0e27\u0e34\u0e49\u0e07' }, { e: '\u{1f498}', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 arrow \u0e25\u0e39\u0e01\u0e28\u0e23 cupid' }, { e: '\u{1f49d}', k: 'heart \u0e2b\u0e31\u0e27\u0e43\u0e08 ribbon \u0e23\u0e34\u0e1a\u0e1a\u0e34\u0e49\u0e19 gift' },
      { e: '\u{1f525}', k: 'fire \u0e44\u0e1f hot \u0e23\u0e49\u0e2d\u0e19 \u0e40\u0e1c\u0e32' }, { e: '\u2b50', k: 'star \u0e14\u0e32\u0e27' }, { e: '\u{1f31f}', k: 'star \u0e14\u0e32\u0e27 \u0e40\u0e1b\u0e25\u0e48\u0e07\u0e41\u0e2a\u0e07 glow' }, { e: '\u2728', k: 'sparkle \u0e27\u0e34\u0e49\u0e07 \u0e41\u0e27\u0e27\u0e27\u0e32\u0e27 star' }, { e: '\u{1f4ab}', k: 'dizzy star \u0e14\u0e32\u0e27 \u0e27\u0e34\u0e07\u0e40\u0e27\u0e35\u0e22\u0e19' }, { e: '\u{1f4af}', k: '100 \u0e23\u0e49\u0e2d\u0e22 perfect \u0e40\u0e15\u0e47\u0e21' }, { e: '\u{1f389}', k: 'party \u0e1b\u0e32\u0e23\u0e4c\u0e15\u0e35\u0e49 \u0e09\u0e25\u0e2d\u0e07 celebrate tada' }, { e: '\u{1f38a}', k: 'confetti \u0e09\u0e25\u0e2d\u0e07 celebrate' }, { e: '\u{1f3c6}', k: 'trophy \u0e16\u0e49\u0e27\u0e22 \u0e41\u0e0a\u0e21\u0e1b\u0e4c winner' },
    ]},
    { label: '\u0e2d\u0e32\u0e2b\u0e32\u0e23 & \u0e40\u0e04\u0e23\u0e37\u0e48\u0e2d\u0e07\u0e14\u0e37\u0e48\u0e21', key: 'food', items: [
      { e: '\u{1f34e}', k: 'apple \u0e41\u0e2d\u0e1b\u0e40\u0e1b\u0e34\u0e49\u0e25 \u0e1c\u0e25\u0e44\u0e21\u0e49 fruit' }, { e: '\u{1f34a}', k: 'orange \u0e2a\u0e49\u0e21 \u0e1c\u0e25\u0e44\u0e21\u0e49 fruit' }, { e: '\u{1f34b}', k: 'lemon \u0e40\u0e25\u0e21\u0e2d\u0e19 \u0e21\u0e30\u0e19\u0e32\u0e27 fruit' }, { e: '\u{1f34c}', k: 'banana \u0e01\u0e25\u0e49\u0e27\u0e22 \u0e1c\u0e25\u0e44\u0e21\u0e49 fruit' }, { e: '\u{1f349}', k: 'watermelon \u0e41\u0e15\u0e07\u0e42\u0e21 \u0e1c\u0e25\u0e44\u0e21\u0e49 fruit' }, { e: '\u{1f347}', k: 'grape \u0e2d\u0e07\u0e38\u0e48\u0e19 \u0e1c\u0e25\u0e44\u0e21\u0e49 fruit' }, { e: '\u{1f353}', k: 'strawberry \u0e2a\u0e15\u0e23\u0e2d\u0e40\u0e1a\u0e2d\u0e23\u0e35\u0e48 \u0e1c\u0e25\u0e44\u0e21\u0e49 fruit' }, { e: '\u{1f351}', k: 'peach \u0e1e\u0e35\u0e0a \u0e25\u0e39\u0e01\u0e17\u0e49\u0e2d \u0e1c\u0e25\u0e44\u0e21\u0e49 fruit' }, { e: '\u{1f96d}', k: 'mango \u0e21\u0e30\u0e21\u0e48\u0e27\u0e07 \u0e1c\u0e25\u0e44\u0e21\u0e49 fruit' }, { e: '\u{1f34d}', k: 'pineapple \u0e2a\u0e31\u0e1a\u0e1b\u0e30\u0e23\u0e14 \u0e1c\u0e25\u0e44\u0e21\u0e49 fruit' },
      { e: '\u{1f951}', k: 'avocado \u0e2d\u0e30\u0e42\u0e27\u0e04\u0e32\u0e42\u0e14' }, { e: '\u{1f346}', k: 'eggplant \u0e21\u0e30\u0e40\u0e02\u0e37\u0e2d' }, { e: '\u{1f966}', k: 'broccoli \u0e1a\u0e23\u0e47\u0e2d\u0e04\u0e42\u0e04\u0e25\u0e35\u0e48 \u0e1c\u0e31\u0e01' }, { e: '\u{1f955}', k: 'carrot \u0e41\u0e04\u0e23\u0e2d\u0e17 \u0e1c\u0e31\u0e01' }, { e: '\u{1f33d}', k: 'corn \u0e02\u0e49\u0e32\u0e27\u0e42\u0e1e\u0e14' }, { e: '\u{1f336}\ufe0f', k: 'chili \u0e1e\u0e23\u0e34\u0e01 \u0e40\u0e1c\u0e47\u0e14 hot' },
      { e: '\u{1f354}', k: 'burger \u0e40\u0e1a\u0e2d\u0e23\u0e4c\u0e40\u0e01\u0e2d\u0e23\u0e4c \u0e41\u0e2e\u0e21\u0e40\u0e1a\u0e2d\u0e23\u0e4c\u0e40\u0e01\u0e2d\u0e23\u0e4c' }, { e: '\u{1f35f}', k: 'fries \u0e40\u0e1f\u0e23\u0e19\u0e0a\u0e4c\u0e1f\u0e23\u0e32\u0e22 \u0e21\u0e31\u0e19\u0e17\u0e2d\u0e14' }, { e: '\u{1f355}', k: 'pizza \u0e1e\u0e34\u0e0b\u0e0b\u0e48\u0e32' }, { e: '\u{1f32d}', k: 'hotdog \u0e2e\u0e2d\u0e17\u0e14\u0e2d\u0e01' }, { e: '\u{1f96a}', k: 'sandwich \u0e41\u0e0b\u0e19\u0e14\u0e4c\u0e27\u0e34\u0e0a' }, { e: '\u{1f32e}', k: 'taco \u0e17\u0e32\u0e42\u0e01\u0e49' }, { e: '\u{1f35d}', k: 'pasta \u0e1e\u0e32\u0e2a\u0e15\u0e49\u0e32 \u0e2a\u0e1b\u0e32\u0e40\u0e01\u0e47\u0e15\u0e15\u0e35\u0e49' }, { e: '\u{1f35c}', k: 'noodle \u0e01\u0e4b\u0e27\u0e22\u0e40\u0e15\u0e35\u0e4b\u0e22\u0e27 \u0e1a\u0e30\u0e2b\u0e21\u0e35\u0e48 ramen' }, { e: '\u{1f372}', k: 'stew \u0e41\u0e01\u0e07 \u0e15\u0e49\u0e21 soup' }, { e: '\u{1f35b}', k: 'curry \u0e41\u0e01\u0e07 \u0e02\u0e49\u0e32\u0e27\u0e41\u0e01\u0e07' },
      { e: '\u{1f363}', k: 'sushi \u0e0b\u0e39\u0e0a\u0e34 \u0e0d\u0e35\u0e48\u0e1b\u0e38\u0e48\u0e19' }, { e: '\u{1f371}', k: 'bento \u0e40\u0e1a\u0e19\u0e42\u0e15\u0e30 \u0e02\u0e49\u0e32\u0e27\u0e01\u0e25\u0e48\u0e2d\u0e07' }, { e: '\u{1f95f}', k: 'dumpling \u0e40\u0e01\u0e35\u0e4a\u0e22\u0e27' }, { e: '\u{1f364}', k: 'shrimp \u0e01\u0e38\u0e49\u0e07 tempura' }, { e: '\u{1f359}', k: 'rice ball \u0e02\u0e49\u0e32\u0e27\u0e1b\u0e31\u0e49\u0e19 \u0e42\u0e2d\u0e19\u0e34\u0e01\u0e34\u0e23\u0e34' },
      { e: '\u{1f366}', k: 'ice cream \u0e44\u0e2d\u0e28\u0e01\u0e23\u0e35\u0e21 \u0e44\u0e2d\u0e15\u0e34\u0e21' }, { e: '\u{1f369}', k: 'donut \u0e42\u0e14\u0e19\u0e31\u0e17' }, { e: '\u{1f36a}', k: 'cookie \u0e04\u0e38\u0e01\u0e01\u0e35\u0e49' }, { e: '\u{1f382}', k: 'cake \u0e40\u0e04\u0e49\u0e01 \u0e27\u0e31\u0e19\u0e40\u0e01\u0e34\u0e14 birthday' }, { e: '\u{1f370}', k: 'cake \u0e40\u0e04\u0e49\u0e01 \u0e0a\u0e35\u0e2a\u0e40\u0e04\u0e49\u0e01' }, { e: '\u{1f9c1}', k: 'cupcake \u0e04\u0e31\u0e1e\u0e40\u0e04\u0e49\u0e01' }, { e: '\u{1f36b}', k: 'chocolate \u0e0a\u0e47\u0e2d\u0e04\u0e42\u0e01\u0e41\u0e25\u0e15' }, { e: '\u{1f36c}', k: 'candy \u0e25\u0e39\u0e01\u0e2d\u0e21' }, { e: '\u{1f36d}', k: 'lollipop \u0e2d\u0e21\u0e22\u0e34\u0e49\u0e21' },
      { e: '\u2615', k: 'coffee \u0e01\u0e32\u0e41\u0e1f \u0e23\u0e49\u0e2d\u0e19 hot' }, { e: '\u{1f375}', k: 'tea \u0e0a\u0e32' }, { e: '\u{1f9cb}', k: 'bubble tea \u0e0a\u0e32\u0e19\u0e21 \u0e1a\u0e34\u0e27\u0e40\u0e1a\u0e34\u0e49\u0e25 \u0e42\u0e1a\u0e1a\u0e32 boba' }, { e: '\u{1f964}', k: 'drink \u0e40\u0e04\u0e23\u0e37\u0e48\u0e2d\u0e07\u0e14\u0e37\u0e48\u0e21 \u0e19\u0e49\u0e33' }, { e: '\u{1f37a}', k: 'beer \u0e40\u0e1a\u0e35\u0e22\u0e23\u0e4c' }, { e: '\u{1f37b}', k: 'cheers \u0e0a\u0e19 \u0e40\u0e1a\u0e35\u0e22\u0e23\u0e4c beer' }, { e: '\u{1f942}', k: 'champagne \u0e41\u0e0a\u0e21\u0e40\u0e1b\u0e0d \u0e09\u0e25\u0e2d\u0e07 toast' }, { e: '\u{1f377}', k: 'wine \u0e44\u0e27\u0e19\u0e4c' },
    ]},
    { label: '\u0e2a\u0e31\u0e15\u0e27\u0e4c & \u0e18\u0e23\u0e23\u0e21\u0e0a\u0e32\u0e15\u0e34', key: 'animal', items: [
      { e: '\u{1f436}', k: 'dog \u0e2b\u0e21\u0e32 \u0e2a\u0e38\u0e19\u0e31\u0e02' }, { e: '\u{1f431}', k: 'cat \u0e41\u0e21\u0e27' }, { e: '\u{1f42d}', k: 'mouse \u0e2b\u0e19\u0e39' }, { e: '\u{1f439}', k: 'hamster \u0e41\u0e2e\u0e21\u0e2a\u0e40\u0e15\u0e2d\u0e23\u0e4c' }, { e: '\u{1f430}', k: 'rabbit \u0e01\u0e23\u0e30\u0e15\u0e48\u0e32\u0e22' }, { e: '\u{1f98a}', k: 'fox \u0e08\u0e34\u0e49\u0e07\u0e08\u0e2d\u0e01 \u0e2a\u0e38\u0e19\u0e31\u0e02\u0e08\u0e34\u0e49\u0e07\u0e08\u0e2d\u0e01' }, { e: '\u{1f43b}', k: 'bear \u0e2b\u0e21\u0e35' }, { e: '\u{1f43c}', k: 'panda \u0e41\u0e1e\u0e19\u0e14\u0e49\u0e32 \u0e2b\u0e21\u0e35' }, { e: '\u{1f428}', k: 'koala \u0e42\u0e04\u0e2d\u0e32\u0e25\u0e48\u0e32' }, { e: '\u{1f42f}', k: 'tiger \u0e40\u0e2a\u0e37\u0e2d' }, { e: '\u{1f981}', k: 'lion \u0e2a\u0e34\u0e07\u0e42\u0e15' }, { e: '\u{1f42e}', k: 'cow \u0e27\u0e31\u0e27' }, { e: '\u{1f437}', k: 'pig \u0e2b\u0e21\u0e39' }, { e: '\u{1f438}', k: 'frog \u0e01\u0e1a' }, { e: '\u{1f435}', k: 'monkey \u0e25\u0e34\u0e07' },
      { e: '\u{1f414}', k: 'chicken \u0e44\u0e01\u0e48' }, { e: '\u{1f427}', k: 'penguin \u0e40\u0e1e\u0e19\u0e01\u0e27\u0e34\u0e19' }, { e: '\u{1f426}', k: 'bird \u0e19\u0e01' }, { e: '\u{1f986}', k: 'duck \u0e40\u0e1b\u0e47\u0e14' }, { e: '\u{1f985}', k: 'eagle \u0e2d\u0e34\u0e19\u0e17\u0e23\u0e35 \u0e19\u0e01\u0e2d\u0e34\u0e19\u0e17\u0e23\u0e35' }, { e: '\u{1f989}', k: 'owl \u0e19\u0e01\u0e2e\u0e39\u0e01' }, { e: '\u{1f41d}', k: 'bee \u0e1c\u0e36\u0e49\u0e07' }, { e: '\u{1f98b}', k: 'butterfly \u0e1c\u0e35\u0e40\u0e2a\u0e37\u0e49\u0e2d' }, { e: '\u{1f40c}', k: 'snail \u0e2b\u0e2d\u0e22\u0e17\u0e32\u0e01' },
      { e: '\u{1f419}', k: 'octopus \u0e1b\u0e25\u0e32\u0e2b\u0e21\u0e36\u0e01' }, { e: '\u{1f990}', k: 'shrimp \u0e01\u0e38\u0e49\u0e07' }, { e: '\u{1f980}', k: 'crab \u0e1b\u0e39' }, { e: '\u{1f420}', k: 'fish \u0e1b\u0e25\u0e32' }, { e: '\u{1f42c}', k: 'dolphin \u0e42\u0e25\u0e21\u0e32' }, { e: '\u{1f433}', k: 'whale \u0e1b\u0e25\u0e32\u0e27\u0e32\u0e2c \u0e27\u0e32\u0e2c' }, { e: '\u{1f988}', k: 'shark \u0e09\u0e25\u0e32\u0e21' }, { e: '\u{1f418}', k: 'elephant \u0e0a\u0e49\u0e32\u0e07' },
      { e: '\u{1f338}', k: 'cherry blossom \u0e0b\u0e32\u0e01\u0e38\u0e23\u0e30 \u0e14\u0e2d\u0e01\u0e44\u0e21\u0e49 flower' }, { e: '\u{1f337}', k: 'tulip \u0e17\u0e34\u0e27\u0e25\u0e34\u0e1b \u0e14\u0e2d\u0e01\u0e44\u0e21\u0e49 flower' }, { e: '\u{1f339}', k: 'rose \u0e01\u0e38\u0e2b\u0e25\u0e32\u0e1a \u0e14\u0e2d\u0e01\u0e44\u0e21\u0e49 flower' }, { e: '\u{1f33a}', k: 'hibiscus \u0e0a\u0e1a\u0e32 \u0e14\u0e2d\u0e01\u0e44\u0e21\u0e49 flower' }, { e: '\u{1f33b}', k: 'sunflower \u0e17\u0e32\u0e19\u0e15\u0e30\u0e27\u0e31\u0e19 \u0e14\u0e2d\u0e01\u0e44\u0e21\u0e49 flower' }, { e: '\u{1f490}', k: 'bouquet \u0e0a\u0e48\u0e2d\u0e14\u0e2d\u0e01\u0e44\u0e21\u0e49 flower' },
      { e: '\u{1f333}', k: 'tree \u0e15\u0e49\u0e19\u0e44\u0e21\u0e49' }, { e: '\u{1f334}', k: 'palm tree \u0e21\u0e30\u0e1e\u0e23\u0e49\u0e32\u0e27 \u0e1b\u0e32\u0e25\u0e4c\u0e21' }, { e: '\u{1f340}', k: 'clover \u0e42\u0e0a\u0e04\u0e14\u0e35 luck four leaf' }, { e: '\u{1f308}', k: 'rainbow \u0e2a\u0e32\u0e22\u0e23\u0e38\u0e49\u0e07 \u0e23\u0e38\u0e49\u0e07' }, { e: '\u2600\ufe0f', k: 'sun \u0e41\u0e14\u0e14 \u0e1e\u0e23\u0e30\u0e2d\u0e32\u0e17\u0e34\u0e15\u0e22\u0e4c' }, { e: '\u{1f319}', k: 'moon \u0e1e\u0e23\u0e30\u0e08\u0e31\u0e19\u0e17\u0e23\u0e4c \u0e14\u0e27\u0e07\u0e08\u0e31\u0e19\u0e17\u0e23\u0e4c' }, { e: '\u{1f30a}', k: 'wave \u0e04\u0e25\u0e37\u0e48\u0e19 \u0e17\u0e30\u0e40\u0e25 sea ocean' },
    ]},
    { label: '\u0e2a\u0e34\u0e48\u0e07\u0e02\u0e2d\u0e07 & \u0e2a\u0e31\u0e0d\u0e25\u0e31\u0e01\u0e29\u0e13\u0e4c', key: 'objects', items: [
      { e: '\u{1f4ac}', k: 'speech bubble \u0e41\u0e0a\u0e17 chat \u0e1e\u0e39\u0e14' }, { e: '\u2705', k: 'check \u0e16\u0e39\u0e01 \u0e40\u0e2a\u0e23\u0e47\u0e08 done yes' }, { e: '\u274c', k: 'cross \u0e1c\u0e34\u0e14 \u0e44\u0e21\u0e48 no wrong' }, { e: '\u2757', k: 'exclamation \u0e15\u0e01\u0e43\u0e08 \u0e2a\u0e33\u0e04\u0e31\u0e0d important' }, { e: '\u2753', k: 'question \u0e04\u0e33\u0e16\u0e32\u0e21 \u0e16\u0e32\u0e21' }, { e: '\u26a0\ufe0f', k: 'warning \u0e40\u0e15\u0e37\u0e2d\u0e19 \u0e23\u0e30\u0e27\u0e31\u0e07' },
      { e: '\u{1f4cc}', k: 'pin \u0e1b\u0e31\u0e01\u0e2b\u0e21\u0e38\u0e14' }, { e: '\u{1f517}', k: 'link \u0e25\u0e34\u0e07\u0e01\u0e4c \u0e40\u0e0a\u0e37\u0e48\u0e2d\u0e21' }, { e: '\u{1f4a1}', k: 'idea \u0e44\u0e2d\u0e40\u0e14\u0e35\u0e22 \u0e2b\u0e25\u0e2d\u0e14\u0e44\u0e1f light bulb' }, { e: '\u{1f514}', k: 'bell \u0e41\u0e08\u0e49\u0e07\u0e40\u0e15\u0e37\u0e2d\u0e19 notification \u0e01\u0e23\u0e30\u0e14\u0e34\u0e48\u0e07' }, { e: '\u{1f4e3}', k: 'megaphone \u0e1b\u0e23\u0e30\u0e01\u0e32\u0e28 announce' },
      { e: '\u{1f6d2}', k: 'cart \u0e15\u0e30\u0e01\u0e23\u0e49\u0e32 shopping \u0e0a\u0e49\u0e2d\u0e1b\u0e1b\u0e34\u0e49\u0e07' }, { e: '\u{1f4e6}', k: 'package \u0e1e\u0e31\u0e2a\u0e14\u0e38 \u0e01\u0e25\u0e48\u0e2d\u0e07 box' }, { e: '\u{1f69a}', k: 'truck \u0e23\u0e16 \u0e2a\u0e48\u0e07\u0e02\u0e2d\u0e07 delivery' }, { e: '\u2708\ufe0f', k: 'airplane \u0e40\u0e04\u0e23\u0e37\u0e48\u0e2d\u0e07\u0e1a\u0e34\u0e19 \u0e1a\u0e34\u0e19' }, { e: '\u{1f697}', k: 'car \u0e23\u0e16 \u0e23\u0e16\u0e22\u0e19\u0e15\u0e4c' }, { e: '\u{1f3e0}', k: 'house \u0e1a\u0e49\u0e32\u0e19 home' }, { e: '\u{1f3e2}', k: 'office \u0e2d\u0e2d\u0e1f\u0e1f\u0e34\u0e28 \u0e15\u0e36\u0e01 building' },
      { e: '\u{1f381}', k: 'gift \u0e02\u0e2d\u0e07\u0e02\u0e27\u0e31\u0e0d present' }, { e: '\u{1f4f1}', k: 'phone \u0e42\u0e17\u0e23\u0e28\u0e31\u0e1e\u0e17\u0e4c \u0e21\u0e37\u0e2d\u0e16\u0e37\u0e2d mobile' }, { e: '\u{1f4bb}', k: 'computer \u0e04\u0e2d\u0e21\u0e1e\u0e34\u0e27\u0e40\u0e15\u0e2d\u0e23\u0e4c laptop \u0e42\u0e19\u0e49\u0e15\u0e1a\u0e38\u0e4a\u0e04' }, { e: '\u{1f4f7}', k: 'camera \u0e01\u0e25\u0e49\u0e2d\u0e07 \u0e16\u0e48\u0e32\u0e22\u0e23\u0e39\u0e1b photo' }, { e: '\u{1f3ac}', k: 'movie \u0e2b\u0e19\u0e31\u0e07 film clapper' },
      { e: '\u{1f4b0}', k: 'money \u0e40\u0e07\u0e34\u0e19 \u0e16\u0e38\u0e07\u0e40\u0e07\u0e34\u0e19 bag' }, { e: '\u{1f4b3}', k: 'credit card \u0e1a\u0e31\u0e15\u0e23 \u0e08\u0e48\u0e32\u0e22 pay' }, { e: '\u{1f4b5}', k: 'money \u0e40\u0e07\u0e34\u0e19 \u0e18\u0e19\u0e1a\u0e31\u0e15\u0e23 dollar cash' }, { e: '\u{1f4dd}', k: 'memo \u0e08\u0e14 \u0e42\u0e19\u0e49\u0e15 note write \u0e40\u0e02\u0e35\u0e22\u0e19' }, { e: '\u{1f4cb}', k: 'clipboard \u0e23\u0e32\u0e22\u0e01\u0e32\u0e23 list' }, { e: '\u{1f4ca}', k: 'chart \u0e01\u0e23\u0e32\u0e1f \u0e2a\u0e16\u0e34\u0e15\u0e34' },
      { e: '\u{1f5d3}\ufe0f', k: 'calendar \u0e1b\u0e0f\u0e34\u0e17\u0e34\u0e19 \u0e27\u0e31\u0e19 date' }, { e: '\u23f0', k: 'alarm clock \u0e19\u0e32\u0e2c\u0e34\u0e01\u0e32 \u0e40\u0e27\u0e25\u0e32 time' }, { e: '\u{1f511}', k: 'key \u0e01\u0e38\u0e0d\u0e41\u0e08' }, { e: '\u{1f3b5}', k: 'music \u0e40\u0e1e\u0e25\u0e07 \u0e14\u0e19\u0e15\u0e23\u0e35 note' }, { e: '\u{1f3b6}', k: 'music \u0e40\u0e1e\u0e25\u0e07 \u0e14\u0e19\u0e15\u0e23\u0e35 notes' },
      { e: '\u{1f4a4}', k: 'sleep \u0e19\u0e2d\u0e19 \u0e2b\u0e25\u0e31\u0e1a zzz' }, { e: '\u{1f4a8}', k: 'dash \u0e27\u0e34\u0e48\u0e07 \u0e25\u0e21 wind' }, { e: '\u{1f4a6}', k: 'sweat \u0e40\u0e2b\u0e07\u0e37\u0e48\u0e2d \u0e19\u0e49\u0e33 water' },
    ]},
  ];

  const searchLower = emojiSearch.toLowerCase();
  const filteredGroups = emojiSearch
    ? emojiGroups.map(g => ({
        ...g,
        items: g.items.filter(item => item.k.includes(searchLower))
      })).filter(g => g.items.length > 0)
    : emojiGroups;

  return (
    <div className="absolute bottom-full left-1/2 -translate-x-1/2 md:left-0 md:translate-x-0 w-[320px] md:w-[360px] bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg shadow-lg z-30 mb-2" style={{ height: '320px' }}>
      {/* Header: Tabs + Close */}
      <div className="flex items-center border-b border-gray-100 dark:border-slate-700 sticky top-0 bg-white dark:bg-slate-800 rounded-t-lg">
        <button onClick={() => { setEmojiTab('emoji'); setEmojiSearch(''); }} className={`flex-1 py-2.5 text-sm font-medium transition-colors ${emojiTab === 'emoji' ? 'text-amber-500 border-b-2 border-amber-500' : 'text-gray-500 hover:text-gray-700 dark:text-slate-400'}`}>ðŸ˜Š Emoji</button>
        {platform === 'line' && (
          <button onClick={() => { setEmojiTab('sticker'); setEmojiSearch(''); }} className={`flex-1 py-2.5 text-sm font-medium transition-colors ${emojiTab === 'sticker' ? 'text-[#06C755] border-b-2 border-[#06C755]' : 'text-gray-500 hover:text-gray-700 dark:text-slate-400'}`}>ðŸŽ­ Sticker</button>
        )}
        <button onClick={onClose} className="p-2 text-gray-400 hover:text-gray-600 mr-1"><X className="w-4 h-4" /></button>
      </div>

      {/* Emoji Tab */}
      {emojiTab === 'emoji' && (
        <div className="flex flex-col" style={{ height: 'calc(320px - 42px)' }}>
          {/* Search */}
          <div className="px-3 py-2 border-b border-gray-50 dark:border-slate-700/50">
            <div className="relative">
              <Search className="absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400" />
              <input type="text" value={emojiSearch} onChange={(e) => setEmojiSearch(e.target.value)} placeholder="à¸„à¹‰à¸™à¸«à¸² emoji..." className="w-full pl-8 pr-3 py-1.5 text-sm border border-gray-200 dark:border-slate-600 rounded-lg bg-gray-50 dark:bg-slate-700 focus:outline-none focus:ring-1 focus:ring-amber-400 text-gray-700 dark:text-slate-200" />
            </div>
          </div>
          {/* Emoji grid */}
          <div className="flex-1 overflow-y-auto px-3 py-2 space-y-3">
            {filteredGroups.length === 0 ? (
              <div className="text-center text-gray-400 dark:text-slate-500 py-8 text-sm">à¹„à¸¡à¹ˆà¸žà¸š emoji</div>
            ) : filteredGroups.map((group) => (
              <div key={group.key}>
                <div className="text-xs text-gray-400 dark:text-slate-500 mb-1.5 font-medium">{group.label}</div>
                <div className="flex flex-wrap gap-0.5">
                  {group.items.map((item) => (
                    <button key={item.e} onClick={() => { onEmojiSelect(item.e); onClose(); }} className="w-10 h-10 md:w-11 md:h-11 flex items-center justify-center hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg text-2xl md:text-[28px] transition-colors" title={item.k}>
                      {item.e}
                    </button>
                  ))}
                </div>
              </div>
            ))}
          </div>
        </div>
      )}

      {/* Sticker Tab - LINE only */}
      {emojiTab === 'sticker' && platform === 'line' && (
        <div className="overflow-y-auto p-3" style={{ height: 'calc(320px - 42px)' }}>
          {officialStickers.map((pack) => (
            <div key={pack.packageId} className="mb-4">
              <div className="grid grid-cols-4 gap-2">
                {pack.stickers.map((stickerId) => (
                  <button key={stickerId} onClick={() => { onStickerSelect(pack.packageId, stickerId); onClose(); }} className="p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors">
                    <img src={`https://stickershop.line-scdn.net/stickershop/v1/sticker/${stickerId}/iPhone/sticker@2x.png`} alt="sticker" className="w-14 h-14 md:w-16 md:h-16 object-contain mx-auto"
                      onError={(e) => { const img = e.target as HTMLImageElement; if (img.src.includes('@2x')) img.src = `https://stickershop.line-scdn.net/stickershop/v1/sticker/${stickerId}/iPhone/sticker.png`; }} />
                  </button>
                ))}
              </div>
            </div>
          ))}
        </div>
      )}
    </div>
  );
}
